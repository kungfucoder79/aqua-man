<!-- Begin View Wrapper -->
@using AquaMan.Models
@using AquaMan.Services
@inject IFormDataService formHelper


<script>
    function Fill() {
        $.get("/Home/Fill", function (data) {
            $("p").html(data);
        });
    }

    function Drain() {
        $.get("/Home/Drain", function (data) {
            $("p").html(data);
        });
    }

    function Feed() {
        $.get("/Home/Feed", function (data) {
            $("p").html(data);
        });
    }
    function ResetI2C() {
        $.get("/Home/ResetI2C", function (data) {
            $("p").html(data);
        });
    }

    setInterval(GetWaterHeight, 1000);

    function GetWaterHeight() 
	{
        $.get("/Home/GetWaterHeight", function (data) 
		{ 
			var waterPercent = (data / 5) *100;
			$("#waterHeight").css('width', waterPercent + "%");
			$("#WaterNum").html(data);
			
		});
    }
</script>
<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">
                Welcome to the Aqua Man! <br />
                <small>Your complete tank automation system</small>
            </h1>
        </div>
    </div>
    <div class="row">
        <div class="col-md-8">
            <form>
                <button type="button" onclick="Fill()" value="Fill">Fill</button>
                <br />
                <button type="button" onclick="Drain()" value="Drain">Drain</button>
                <br />
                <button type="button" onclick="Feed()" value="Feed">Feed</button>
                <br />
                <button type="button" onclick="ResetI2C()" value="ResetI2C">ResetI2C</button>
                <br />
				<p id="WaterNum"/>
				<br />
                <div class="progress">
                    <progressbar id="waterHeight" />
                </div>
                <br />
            </form>
            @{
                TankSpecs tankSpecs = formHelper.GetTankSpecs();
                @if (tankSpecs.Depth <= 0 && tankSpecs.Width <= 0 && tankSpecs.Height <= 0)
                {
                    <label>Tanks specifications are needed to intitailize the system.</label>
                    <br />
                    <label> Please go to the </label>
                    <a asp-controller="Tank" asp-action="TankSpecs">Tank Setup Page</a>
                }
                @if (formHelper.GetFeedingTimes()?.Feedings[0] == null)
                {
                    <br />
                    <label>At least one feeding time is needed.</label>
                    <br />
                    <label> Please go to the </label>
                    <a asp-controller="Feeding" asp-action="FeedingTimes">Feeding Times Setup Page</a>
                }
            }
        </div>
    </div>
</div>
<!-- End View Wrapper -->
